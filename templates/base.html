<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CineSmart</title>

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>

<!-- Sidebar -->
<aside id="sidebar">
  <div class="logo">
    <h2>CINESMART</h2>
  </div>

  <!-- Categories -->
  <div class="categories">
    <h3>Categories</h3>
    <ul>
      <li><a href="/popular">Popular</a></li>
      <li><a href="/top_rated">Top Rated</a></li>
      <li><a href="/upcoming">Upcoming</a></li>
    </ul>
  </div>

  <!-- Genres -->
  <div class="genres">
    <h3>Genres</h3>
    <ul>
      <li><a href="/genre/28">Action</a></li>
      <li><a href="/genre/12">Adventure</a></li>
      <li><a href="/genre/16">Animation</a></li>
      <li><a href="/genre/35">Comedy</a></li>
      <li><a href="/genre/18">Drama</a></li>
      <li><a href="/genre/14">Fantasy</a></li>
      <li><a href="/genre/27">Horror</a></li>
      <li><a href="/genre/9648">Mystery</a></li>
      <li><a href="/genre/10749">Romance</a></li>
      <li><a href="/genre/878">Sci-Fi</a></li>
    </ul>
  </div>
</aside>

<!-- Search -->
<div id="search">
  <input type="text" id="searchInput" placeholder="Search movies...">
</div>

<!-- Main Content -->
<main>
  {% block content %}{% endblock %}
</main>

<!-- Movie Modal -->
<div id="movie-detail-modal" class="modal">
  <div class="modal-content">
    <span id="close-modal">&times;</span>
    <div id="modal-body"></div>
  </div>
</div>

<!-- Auth Buttons -->
<div id="auth-buttons">
  {% if session.get("user") %}
    <p>Welcome, {{ session["user"] }} ðŸ‘‹</p>
    <a href="/logout">Logout</a>
  {% else %}
    <button id="login-button">Login</button>
    <button id="signup-button">Signup</button>
  {% endif %}
</div>

<!-- Login Modal -->
<div id="login-modal" class="modal">
  <div class="modal-content">
    <span class="close" id="close-login">&times;</span>
    <h2>Login</h2>
    <form action="/login" method="POST">
      <input type="email" name="email" placeholder="Email" required><br><br>
      <input type="password" name="password" placeholder="Password" required><br><br>
      <button type="submit">Login</button>
    </form>
  </div>
</div>

<!-- Signup Modal -->
<div id="signup-modal" class="modal">
  <div class="modal-content">
    <span class="close" id="close-signup">&times;</span>
    <h2>Signup</h2>
    <form action="/signup" method="POST">
      <input type="text" name="username" placeholder="Username" required><br><br>
      <input type="email" name="email" placeholder="Email" required><br><br>
      <input type="password" name="password" placeholder="Password" required><br><br>
      <button type="submit">Signup</button>
    </form>
  </div>
</div>

<!-- âœ… Dialogflow Messenger (WORKING BOT) -->
<script src="https://www.gstatic.com/dialogflow-console/fast/messenger/bootstrap.js?v=1"></script>

<df-messenger
  intent="WELCOME"
  chat-title="CineBot"
  agent-id="6e8067d1-9c19-42eb-8f77-80babcc63bde"
  language-code="en">
</df-messenger>

<!-- Scripts -->
<script src="{{ url_for('static', filename='search.js') }}"></script>

{% block scripts %}{% endblock %}

<!-- Modal Script -->
<script>
document.addEventListener("DOMContentLoaded", function () {

  const loginBtn = document.getElementById("login-button");
  const signupBtn = document.getElementById("signup-button");

  const loginModal = document.getElementById("login-modal");
  const signupModal = document.getElementById("signup-modal");

  const closeLogin = document.getElementById("close-login");
  const closeSignup = document.getElementById("close-signup");

  if (loginBtn) loginBtn.onclick = () => loginModal.style.display = "block";
  if (signupBtn) signupBtn.onclick = () => signupModal.style.display = "block";

  if (closeLogin) closeLogin.onclick = () => loginModal.style.display = "none";
  if (closeSignup) closeSignup.onclick = () => signupModal.style.display = "none";

  window.onclick = function(e) {
    if (e.target === loginModal) loginModal.style.display = "none";
    if (e.target === signupModal) signupModal.style.display = "none";
  };

});
</script>

</body>
</html>
